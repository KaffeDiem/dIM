{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ChatHandler"}],"languages":["swift"],"platforms":["iOS"]}]},{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This class handles almost all the logic in the app and is passed around"},{"type":"text","text":" "},{"type":"text","text":"to the different views such that they all have access to the same Bluetooth"},{"type":"text","text":" "},{"type":"text","text":"objects as well as conversations. When the app is launched all the information"},{"type":"text","text":" "},{"type":"text","text":"is stored in memory and written to the persistent storage as needed."}]},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"It conforms to a variety of delegates which is used for callback functions from the Apple APIs."}]}],"type":"aside","name":"Note"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"In code the ChatBrain has been divided into files for seperation and isolation of features."}]}],"type":"aside","name":"Note"}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/dim\/chathandler"],"traits":[{"interfaceLanguage":"swift"}]}],"relationshipsSections":[{"identifiers":["doc:\/\/xyz.kaspermunch.dim\/objc(cs)NSObject"],"kind":"relationships","title":"Inherits From","type":"inheritsFrom"},{"identifiers":["doc:\/\/xyz.kaspermunch.dim\/7Combine16ObservableObjectP","doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBCentralManagerDelegate","doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBPeripheralDelegate","doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBPeripheralManagerDelegate","doc:\/\/xyz.kaspermunch.dim\/objc(pl)NSObject","doc:\/\/xyz.kaspermunch.dim\/s7CVarArgP","doc:\/\/xyz.kaspermunch.dim\/s28CustomDebugStringConvertibleP","doc:\/\/xyz.kaspermunch.dim\/s23CustomStringConvertibleP","doc:\/\/xyz.kaspermunch.dim\/SQ","doc:\/\/xyz.kaspermunch.dim\/SH"],"kind":"relationships","title":"Conforms To","type":"conformsTo"}],"identifier":{"url":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"The Bluetooth Manager handles all searching for, creating connection to"},{"type":"text","text":" "},{"type":"text","text":"and sending\/receiving messages to\/from other Bluetooth devices."}],"kind":"symbol","metadata":{"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ChatHandler"}],"title":"ChatHandler","roleHeading":"Class","role":"symbol","symbolKind":"class","externalID":"c:@M@dIM@objc(cs)ChatHandler","modules":[{"name":"dIM"}],"navigatorTitle":[{"kind":"identifier","text":"ChatHandler"}]},"hierarchy":{"paths":[["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM"]]},"topicSections":[{"title":"Structures","identifiers":["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/queuedMessage"]},{"title":"Initializers","identifiers":["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/init(context:)"]},{"title":"Instance Properties","identifiers":["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/centralManager","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/characteristic","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/connectedCharateristics","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/context","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/discoveredDevices","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueue","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/peripheralManager","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/peripheralMessages","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/refreshID","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/routedCounter","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/seenCBCentral","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/seenMessages","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/senderOfMessageID"]},{"title":"Instance Methods","identifiers":["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/addMessageToDSRTable(messageID:bluetoothID:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/checkMessageQueue()","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/checkMessageSeenBefore(messageID:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/cleanUpPeripheral(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/decryptRetrievedMessageToString(message:conversation:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/getSenderOfMessage(messageID:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/handleScan(result:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueueAdd(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueueNewConnection(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/receivedAck(message:conversation:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/receivedRead(message:conversation:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/relayMessage(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/relayMessage(_:_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/retrieveMessage(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendAckMessage(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendMessage(for:text:context:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendReadMessage(_:)","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/startAdvertising(peripheralManager:)"]},{"title":"Default Implementations","identifiers":["doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBCentralManagerDelegate-Implementations","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBPeripheralDelegate-Implementations","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBPeripheralManagerDelegate-Implementations","doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/ObservableObject-Implementations"],"generated":true}],"references":{"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/checkMessageQueue()":{"role":"symbol","title":"checkMessageQueue()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"checkMessageQueue"},{"kind":"text","text":"()"}],"abstract":[{"type":"text","text":"Remove old messages from the message queue such that"},{"type":"text","text":" "},{"type":"text","text":"we do not deliver messages older than a set amount."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/checkMessageQueue()","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/checkmessagequeue()"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/seenMessages":{"role":"symbol","title":"seenMessages","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"seenMessages"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"Int32","preciseIdentifier":"s:s5Int32V"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"A list which holds message IDs which we have seen before."},{"type":"text","text":" "},{"type":"text","text":"This prevents looping them in the network for ages."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/seenMessages","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/seenmessages"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/init(context:)":{"role":"symbol","title":"init(context:)","fragments":[{"kind":"identifier","text":"init"},{"kind":"text","text":"("},{"kind":"externalParam","text":"context"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"NSManagedObjectContext","preciseIdentifier":"c:objc(cs)NSManagedObjectContext"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"The initialiser for the ChatBrain."},{"type":"text","text":" "},{"type":"text","text":"Sets up the "},{"type":"codeVoice","code":"centralManager"},{"type":"text","text":" and the "},{"type":"codeVoice","code":"peripheralManager"},{"type":"text","text":"."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/init(context:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/init(context:)"},"doc://xyz.kaspermunch.dim/s23CustomStringConvertibleP":{"type":"unresolvable","title":"Swift.CustomStringConvertible","identifier":"doc:\/\/xyz.kaspermunch.dim\/s23CustomStringConvertibleP"},"doc://xyz.kaspermunch.dim/s28CustomDebugStringConvertibleP":{"type":"unresolvable","title":"Swift.CustomDebugStringConvertible","identifier":"doc:\/\/xyz.kaspermunch.dim\/s28CustomDebugStringConvertibleP"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/queuedMessage":{"role":"symbol","title":"ChatHandler.queuedMessage","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"queuedMessage"}],"abstract":[{"type":"text","text":"A message stored together with a date for queue."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/queuedMessage","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"queuedMessage"}],"url":"\/documentation\/dim\/chathandler\/queuedmessage"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/addMessageToDSRTable(messageID:bluetoothID:)":{"role":"symbol","title":"addMessageToDSRTable(messageID:bluetoothID:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"addMessageToDSRTable"},{"kind":"text","text":"("},{"kind":"externalParam","text":"messageID"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int32","preciseIdentifier":"s:s5Int32V"},{"kind":"text","text":", "},{"kind":"externalParam","text":"bluetoothID"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Add a message to the dicitionary when it is received."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/addMessageToDSRTable(messageID:bluetoothID:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/addmessagetodsrtable(messageid:bluetoothid:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/characteristic":{"role":"symbol","title":"characteristic","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"characteristic"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"CBMutableCharacteristic","preciseIdentifier":"c:objc(cs)CBMutableCharacteristic"},{"kind":"text","text":"?"}],"abstract":[{"type":"text","text":"The characteristic which defines our chat functionality for the"},{"type":"text","text":" "},{"type":"text","text":"Bluetooth API."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/characteristic","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/characteristic"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/routedCounter":{"role":"symbol","title":"routedCounter","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"routedCounter"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int","preciseIdentifier":"s:Si"}],"abstract":[{"type":"text","text":"A simple counter to show amount of relayed messages this session."},{"type":"text","text":" "},{"type":"text","text":"It is reset when the app is force-closed or the device is restarted."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/routedCounter","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/routedcounter"},"doc://xyz.kaspermunch.dim/objc(pl)NSObject":{"type":"unresolvable","title":"ObjectiveC.NSObjectProtocol","identifier":"doc:\/\/xyz.kaspermunch.dim\/objc(pl)NSObject"},"doc://xyz.kaspermunch.dim/s7CVarArgP":{"type":"unresolvable","title":"Swift.CVarArg","identifier":"doc:\/\/xyz.kaspermunch.dim\/s7CVarArgP"},"doc://xyz.kaspermunch.dim/documentation/dIM":{"role":"collection","title":"dIM","abstract":[{"type":"text","text":"An instant messenger app that works by using Bluetooth."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM","kind":"symbol","type":"topic","url":"\/documentation\/dim"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/checkMessageSeenBefore(messageID:)":{"role":"symbol","title":"checkMessageSeenBefore(messageID:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"checkMessageSeenBefore"},{"kind":"text","text":"("},{"kind":"externalParam","text":"messageID"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int32","preciseIdentifier":"s:s5Int32V"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Check if we have seen a message before. If we have not we will"},{"type":"text","text":" "},{"type":"text","text":"flood the network."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/checkMessageSeenBefore(messageID:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/checkmessageseenbefore(messageid:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/sendReadMessage(_:)":{"role":"symbol","title":"sendReadMessage(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"sendReadMessage"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"ConversationEntity","preciseIdentifier":"c:@M@dIM@objc(cs)ConversationEntity"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Sends a message of idâ€™s which confirms that we have read the"},{"type":"text","text":" "},{"type":"text","text":"received messages."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendReadMessage(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/sendreadmessage(_:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/connectedCharateristics":{"role":"symbol","title":"connectedCharateristics","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"connectedCharateristics"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"CBCharacteristic","preciseIdentifier":"c:objc(cs)CBCharacteristic"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Holds the connected characteristics. This is only used for the chat"},{"type":"text","text":" "},{"type":"text","text":"functionality for now."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/connectedCharateristics","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/connectedcharateristics"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/getSenderOfMessage(messageID:)":{"role":"symbol","title":"getSenderOfMessage(messageID:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"getSenderOfMessage"},{"kind":"text","text":"("},{"kind":"externalParam","text":"messageID"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int32","preciseIdentifier":"s:s5Int32V"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"}],"abstract":[{"type":"text","text":"Get the sender of a message given a message id."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/getSenderOfMessage(messageID:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/getsenderofmessage(messageid:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/cleanUpPeripheral(_:)":{"role":"symbol","title":"cleanUpPeripheral(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"cleanUpPeripheral"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"CBPeripheral","preciseIdentifier":"c:objc(cs)CBPeripheral"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Remove a device from discoveredDevices and drop connection to it."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/cleanUpPeripheral(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/cleanupperipheral(_:)"},"doc://xyz.kaspermunch.dim/objc(pl)CBPeripheralManagerDelegate":{"type":"unresolvable","title":"CoreBluetooth.CBPeripheralManagerDelegate","identifier":"doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBPeripheralManagerDelegate"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/senderOfMessageID":{"role":"symbol","title":"senderOfMessageID","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"senderOfMessageID"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"Int32","preciseIdentifier":"s:s5Int32V"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"A dictionary which holds the ids of messages relayed and the corresponding sender"},{"type":"text","text":" "},{"type":"text","text":"of said messages. This is used for DSR."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/senderOfMessageID","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/senderofmessageid"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/startAdvertising(peripheralManager:)":{"role":"symbol","title":"startAdvertising(peripheralManager:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"startAdvertising"},{"kind":"text","text":"("},{"kind":"externalParam","text":"peripheralManager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"CBPeripheralManager","preciseIdentifier":"c:objc(cs)CBPeripheralManager"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Start advertisting that we are here to nearby Bluetooth central managers."},{"type":"text","text":" "},{"type":"text","text":"This is a callback function and called automatically."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/startAdvertising(peripheralManager:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/startadvertising(peripheralmanager:)"},"doc://xyz.kaspermunch.dim/SH":{"type":"unresolvable","title":"Swift.Hashable","identifier":"doc:\/\/xyz.kaspermunch.dim\/SH"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/messageQueueAdd(_:)":{"role":"symbol","title":"messageQueueAdd(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"messageQueueAdd"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Add a message to the message queue."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueueAdd(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/messagequeueadd(_:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/discoveredDevices":{"role":"symbol","title":"discoveredDevices","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"discoveredDevices"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"Device","preciseIdentifier":"s:3dIM6DeviceV"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Holds a reference to all devices discovered. If no reference"},{"type":"text","text":" "},{"type":"text","text":"is held then the Bluetooth connection may be dropped."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/discoveredDevices","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/discovereddevices"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/relayMessage(_:_:)":{"role":"symbol","title":"relayMessage(_:_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"relayMessage"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Relay message but to be used for "},{"type":"codeVoice","code":"DSR"},{"type":"text","text":" routing."},{"type":"text","text":" "},{"type":"text","text":"Therefore we require a specific Bluetooth ID to send the send the message to."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/relayMessage(_:_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/relaymessage(_:_:)"},"doc://xyz.kaspermunch.dim/7Combine16ObservableObjectP":{"type":"unresolvable","title":"Combine.ObservableObject","identifier":"doc:\/\/xyz.kaspermunch.dim\/7Combine16ObservableObjectP"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/handleScan(result:)":{"role":"symbol","title":"handleScan(result:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"handleScan"},{"kind":"text","text":"("},{"kind":"externalParam","text":"result"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":")"}],"abstract":[],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/handleScan(result:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/handlescan(result:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/peripheralMessages":{"role":"symbol","title":"peripheralMessages","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"peripheralMessages"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":" : ["},{"kind":"typeIdentifier","text":"Date","preciseIdentifier":"s:10Foundation4DateV"},{"kind":"text","text":"]]"}],"abstract":[{"type":"text","text":"A dictionary which stores how many messages we have received from a connected peripheral."},{"type":"text","text":" "},{"type":"text","text":"It is cleaned from time to time as well."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/peripheralMessages","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/peripheralmessages"},"doc://xyz.kaspermunch.dim/objc(pl)CBCentralManagerDelegate":{"type":"unresolvable","title":"CoreBluetooth.CBCentralManagerDelegate","identifier":"doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBCentralManagerDelegate"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler":{"role":"symbol","title":"ChatHandler","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ChatHandler"}],"abstract":[{"type":"text","text":"The Bluetooth Manager handles all searching for, creating connection to"},{"type":"text","text":" "},{"type":"text","text":"and sending\/receiving messages to\/from other Bluetooth devices."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ChatHandler"}],"url":"\/documentation\/dim\/chathandler"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/context":{"role":"symbol","title":"context","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"context"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"NSManagedObjectContext","preciseIdentifier":"c:objc(cs)NSManagedObjectContext"}],"abstract":[{"type":"text","text":"Context for CoreData storage"}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/context","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/context"},"doc://xyz.kaspermunch.dim/objc(pl)CBPeripheralDelegate":{"type":"unresolvable","title":"CoreBluetooth.CBPeripheralDelegate","identifier":"doc:\/\/xyz.kaspermunch.dim\/objc(pl)CBPeripheralDelegate"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/refreshID":{"role":"symbol","title":"refreshID","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"refreshID"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"UUID","preciseIdentifier":"s:10Foundation4UUIDV"}],"abstract":[{"type":"text","text":"A UUID which is updated when a "},{"type":"strong","inlineContent":[{"type":"text","text":"ACK"}]},{"type":"text","text":" message is retrieved. This forces"},{"type":"text","text":" "},{"type":"text","text":"a refresh of the "},{"type":"codeVoice","code":"ChatView"},{"type":"text","text":" and the message status is updated."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/refreshID","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/refreshid"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/decryptRetrievedMessageToString(message:conversation:)":{"role":"symbol","title":"decryptRetrievedMessageToString(message:conversation:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"decryptRetrievedMessageToString"},{"kind":"text","text":"("},{"kind":"externalParam","text":"message"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"conversation"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ConversationEntity","preciseIdentifier":"c:@M@dIM@objc(cs)ConversationEntity"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":"?"}],"abstract":[{"type":"text","text":"A helper function to decrypt a message to a string."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/decryptRetrievedMessageToString(message:conversation:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/decryptretrievedmessagetostring(message:conversation:)"},"doc://xyz.kaspermunch.dim/objc(cs)NSObject":{"type":"unresolvable","title":"ObjectiveC.NSObject","identifier":"doc:\/\/xyz.kaspermunch.dim\/objc(cs)NSObject"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/receivedRead(message:conversation:)":{"role":"symbol","title":"receivedRead(message:conversation:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"receivedRead"},{"kind":"text","text":"("},{"kind":"externalParam","text":"message"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"conversation"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ConversationEntity","preciseIdentifier":"c:@M@dIM@objc(cs)ConversationEntity"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Called if we have received a "},{"type":"codeVoice","code":"READ"},{"type":"text","text":" message type. This is to handle"},{"type":"text","text":" "},{"type":"text","text":"that type of messages correctly."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/receivedRead(message:conversation:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/receivedread(message:conversation:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/relayMessage(_:)":{"role":"symbol","title":"relayMessage(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"relayMessage"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Relay a message which we have received and is not for us."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/relayMessage(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/relaymessage(_:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/peripheralManager":{"role":"symbol","title":"peripheralManager","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"peripheralManager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"CBPeripheralManager","preciseIdentifier":"c:objc(cs)CBPeripheralManager"},{"kind":"text","text":"!"}],"abstract":[{"type":"text","text":"The peripheralManager acts as our Bluetooth clients and establishes"},{"type":"text","text":" "},{"type":"text","text":"connections to other BT servers. It also sends messages."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/peripheralManager","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/peripheralmanager"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/sendMessage(for:text:context:)":{"role":"symbol","title":"sendMessage(for:text:context:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"sendMessage"},{"kind":"text","text":"("},{"kind":"externalParam","text":"for"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ConversationEntity","preciseIdentifier":"c:@M@dIM@objc(cs)ConversationEntity"},{"kind":"text","text":", "},{"kind":"externalParam","text":"text"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":", "},{"kind":"externalParam","text":"context"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"NSManagedObjectContext","preciseIdentifier":"c:objc(cs)NSManagedObjectContext"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Sends a message to a specific user."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendMessage(for:text:context:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/sendmessage(for:text:context:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/centralManager":{"role":"symbol","title":"centralManager","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"centralManager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"CBCentralManager","preciseIdentifier":"c:objc(cs)CBCentralManager"},{"kind":"text","text":"!"}],"abstract":[{"type":"text","text":"The centralManager acts as our Bluetooth server and receives messages"},{"type":"text","text":" "},{"type":"text","text":"sent by clients to the server."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/centralManager","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/centralmanager"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/CBPeripheralDelegate-Implementations":{"role":"collectionGroup","title":"CBPeripheralDelegate Implementations","abstract":[],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBPeripheralDelegate-Implementations","kind":"article","type":"topic","url":"\/documentation\/dim\/chathandler\/cbperipheraldelegate-implementations"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/seenCBCentral":{"role":"symbol","title":"seenCBCentral","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"seenCBCentral"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"CBCentral","preciseIdentifier":"c:objc(cs)CBCentral"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Seen CBCentrals \/ This is used for DSR algorithm."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/seenCBCentral","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/seencbcentral"},"doc://xyz.kaspermunch.dim/SQ":{"type":"unresolvable","title":"Swift.Equatable","identifier":"doc:\/\/xyz.kaspermunch.dim\/SQ"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/CBPeripheralManagerDelegate-Implementations":{"role":"collectionGroup","title":"CBPeripheralManagerDelegate Implementations","abstract":[],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBPeripheralManagerDelegate-Implementations","kind":"article","type":"topic","url":"\/documentation\/dim\/chathandler\/cbperipheralmanagerdelegate-implementations"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/receivedAck(message:conversation:)":{"role":"symbol","title":"receivedAck(message:conversation:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"receivedAck"},{"kind":"text","text":"("},{"kind":"externalParam","text":"message"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"conversation"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ConversationEntity","preciseIdentifier":"c:@M@dIM@objc(cs)ConversationEntity"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Handles "},{"type":"codeVoice","code":"ACK"},{"type":"text","text":" message types. Also confirms that the message is correctly"},{"type":"text","text":" "},{"type":"text","text":"formatted and updates the conversation."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/receivedAck(message:conversation:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/receivedack(message:conversation:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/messageQueueNewConnection(_:)":{"role":"symbol","title":"messageQueueNewConnection(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"messageQueueNewConnection"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"CBCentral","preciseIdentifier":"c:objc(cs)CBCentral"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Called when we establish a new connection to a central manager."},{"type":"text","text":" "},{"type":"text","text":"This sends over all the queued messages but clean up first"},{"type":"text","text":" "},{"type":"text","text":"such that no old messages are sent."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueueNewConnection(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/messagequeuenewconnection(_:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/messageQueue":{"role":"symbol","title":"messageQueue","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"messageQueue"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"queuedMessage","preciseIdentifier":"s:3dIM11ChatHandlerC13queuedMessageV"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Holds an array of messages to be delivered at a later point."},{"type":"text","text":" "},{"type":"text","text":"Used for the queue functionality."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/messageQueue","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/messagequeue"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/sendAckMessage(_:)":{"role":"symbol","title":"sendAckMessage(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"sendAckMessage"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"MessageEntity","preciseIdentifier":"c:@M@dIM@objc(cs)MessageEntity"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Sends an "},{"type":"codeVoice","code":"ACK"},{"type":"text","text":" message to confirm that we have received a message."},{"type":"text","text":" "},{"type":"text","text":"If we use DSR (Dynamic Source Routing) this messages is sent on the"},{"type":"text","text":" "},{"type":"text","text":"shortest route possible."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/sendAckMessage(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/sendackmessage(_:)"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/CBCentralManagerDelegate-Implementations":{"role":"collectionGroup","title":"CBCentralManagerDelegate Implementations","abstract":[],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/CBCentralManagerDelegate-Implementations","kind":"article","type":"topic","url":"\/documentation\/dim\/chathandler\/cbcentralmanagerdelegate-implementations"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/ObservableObject-Implementations":{"role":"collectionGroup","title":"ObservableObject Implementations","abstract":[],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/ObservableObject-Implementations","kind":"article","type":"topic","url":"\/documentation\/dim\/chathandler\/observableobject-implementations"},"doc://xyz.kaspermunch.dim/documentation/dIM/ChatHandler/retrieveMessage(_:)":{"role":"symbol","title":"retrieveMessage(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"retrieveMessage"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Message","preciseIdentifier":"s:3dIM7MessageV"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Retrieve a message from a sender and handle it accordingly."}],"identifier":"doc:\/\/xyz.kaspermunch.dim\/documentation\/dIM\/ChatHandler\/retrieveMessage(_:)","kind":"symbol","type":"topic","url":"\/documentation\/dim\/chathandler\/retrievemessage(_:)"}}}